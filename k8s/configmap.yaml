apiVersion: v1
kind: ConfigMap
metadata:
  name: customer-service-config
  labels:
    app: customer-service
data:
  # ============================================================
  # Application Configuration
  # ============================================================
  # This ConfigMap demonstrates how configuration can be
  # externalized from the application code.
  #
  # In Service Mesh (Istio):
  # - Configuration is managed by Istio control plane
  # - Envoy config is automatically generated
  # - No manual ConfigMaps needed for sidecar config
  # ============================================================
  
  application.yml: |
    server:
      port: 9090
    
    spring:
      application:
        name: customer-service
    
    sidecar:
      logging:
        url: http://localhost:8080/logs
        enabled: true
    
    management:
      endpoints:
        web:
          exposure:
            include: health,info
      endpoint:
        health:
          show-details: always

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: logging-sidecar-config
  labels:
    app: customer-service
    component: logging-sidecar
data:
  # ============================================================
  # Sidecar Configuration
  # ============================================================
  # In a real implementation, this would configure:
  # - Log destinations (Elasticsearch, Splunk, etc.)
  # - Filtering rules
  # - Sampling rates
  # - Retention policies
  #
  # In Service Mesh (Istio):
  # - Envoy config is generated by Istio pilot
  # - Configuration is centralized in Istio CRDs
  # - Example: VirtualService, DestinationRule, etc.
  # ============================================================
  
  config.json: |
    {
      "sidecar": {
        "version": "1.0.0",
        "type": "logging",
        "destinations": [
          {
            "type": "stdout",
            "enabled": true
          }
        ],
        "filters": {
          "minLevel": "INFO",
          "excludePatterns": []
        }
      }
    }

